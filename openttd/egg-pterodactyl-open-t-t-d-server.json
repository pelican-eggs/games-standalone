{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2024-11-23T00:00:00+00:00",
    "name": "OpenTTD",
    "author": "artline86@gmailc.com",
    "description": "OpenTTD is an open-source simulation game based on Transport Tycoon Deluxe.",
    "features": null,
    "docker_images": {
        "ghcr.io/parkervcp/yolks:debian": "ghcr.io/parkervcp/yolks:debian"
    },
    "file_denylist": [],
    "startup": "./openttd -D -c openttd.cfg",
    "config": {
        "files": "{\r\n    \"openttd.cfg\": {\r\n        \"parser\": \"ini\",\r\n        \"find\": {\r\n            \"network.server_port\": \"{{server.build.default.port}}\",\r\n            \"network.server_name\": \"{{server.build.env.srv_name}}\",\r\n            \"network.server_advertise\": \"{{server.build.env.srv_advertise}}\",\r\n            \"network.lan_internet\": 0\r\n        }\r\n    }\r\n}",
        "startup": "{\r\n    \"done\": \"Map generated, starting game\"\r\n}",
        "logs": "{}",
        "stop": "exit"
    },
    "scripts": {
        "installation": {
            "script": "#!/bin/ash\n# Install dependencies\napk add --no-cache xz curl tar unzip jq\n\n# Create server directory\nmkdir -p /mnt/server\ncd /mnt/server\n\n# Determine OpenTTD version\nif [ \"${OPENTTD_VERSION}\" = \"latest\" ]; then\n    echo \"Fetching the latest OpenTTD version...\"\n    OPENTTD_VERSION=$(curl -s https://api.github.com/repos/OpenTTD/OpenTTD/releases/latest | jq -r .tag_name)\n    if [ -z \"$OPENTTD_VERSION\" ]; then\n        echo \"Error: Failed to fetch the latest OpenTTD version.\"\n        exit 1\n    fi\n    echo \"Detected latest OpenTTD version: $OPENTTD_VERSION\"\nfi\n\n# Determine OpenGFX version\nif [ \"${OPENGFX_VERSION}\" = \"latest\" ]; then\n    echo \"Fetching the latest OpenGFX version...\"\n    OPENGFX_VERSION=$(curl -s https://api.github.com/repos/OpenTTD/OpenGFX/releases/latest | jq -r .tag_name)\n    if [ -z \"$OPENGFX_VERSION\" ]; then\n        echo \"Error: Failed to fetch the latest OpenGFX version. Defaulting to 7.1.\"\n        OPENGFX_VERSION=\"7.1\"\n    fi\n    echo \"Detected OpenGFX version: $OPENGFX_VERSION\"\nfi\n\n# Download and unpack OpenTTD\nDOWNLOAD_URL=\"https://cdn.openttd.org/openttd-releases/${OPENTTD_VERSION}/openttd-${OPENTTD_VERSION}-linux-generic-amd64.tar.xz\"\necho \"Downloading OpenTTD from: $DOWNLOAD_URL\"\ncurl -o openttd.tar.xz -sSL $DOWNLOAD_URL\n\necho \"Unpacking OpenTTD...\"\ntar -xf openttd.tar.xz --strip-components=1\nrm openttd.tar.xz\nchmod +x openttd\n\n# Download and unpack OpenGFX\nOPENGFX_URL=\"https://cdn.openttd.org/opengfx-releases/${OPENGFX_VERSION}/opengfx-${OPENGFX_VERSION}-all.zip\"\necho \"Downloading OpenGFX from: $OPENGFX_URL\"\ncurl -o opengfx.zip -sSL $OPENGFX_URL\nunzip -o opengfx.zip\nmkdir -p /mnt/server/baseset\ntar -xvf opengfx*.tar -C /mnt/server/baseset/ --strip-components=1\n\n# Ensure baseset directory exists\nif [ ! -d /mnt/server/baseset ]; then\n    echo \"Error: Failed to create the baseset directory.\"\n    exit 1\nfi\n\n# Verify graphics set installation\nif [ ! -f /mnt/server/baseset/opengfx.obg ]; then\n    echo \"Error: Graphics set not properly installed. Please check the OpenGFX download.\"\n    exit 1\nfi\n\n# Clean up temporary files\nrm -f opengfx*.zip opengfx*.tar\n\n# Create default configuration\nif [ ! -f /mnt/server/openttd.cfg ]; then\n    echo \"Creating default configuration file...\"\n    cat <<EOL > /mnt/server/openttd.cfg\n[network]\nserver_name = OpenTTD Server\nserver_password =\nserver_port = 3979\nmax_clients = 10\nmax_companies = 5\nmax_spectators = 5\nlan_internet = 1\nEOL\nfi\n\n## Installation complete\necho \"Installation completed successfully.\"",
            "container": "alpine:latest",
            "entrypoint": "ash"
        }
    },
    "variables": [
        {
            "name": "Server Name",
            "description": "The name shown in the server list.",
            "env_variable": "srv_name",
            "default_value": "OpenTTD Server",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:100",
            "field_type": "text"
        },
        {
            "name": "Advertise Server",
            "description": "Whether to advertise the server on the master server list (true/false).",
            "env_variable": "srv_advertise",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "OpenTTD Version",
            "description": "Specify the OpenTTD version to use (e.g., 13.0, or latest).",
            "env_variable": "OPENTTD_VERSION",
            "default_value": "latest",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:20",
            "field_type": "text"
        },
        {
            "name": "OpenGFX Version",
            "description": "Specify the OpenGFX version to use (e.g., 7.1, or latest).",
            "env_variable": "OPENGFX_VERSION",
            "default_value": "latest",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:20",
            "field_type": "text"
        }
    ]
}
